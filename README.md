# cmcc：模拟四川移动掌上营业厅的客户端，自动签到，自动抽奖
### 写在前面
四川移动掌厅就是那个可以领流量的图标是熊猫的app。想当年我还在用移动的电话卡的时候，每个月都会屁颠屁颠的用这个软件抽奖和签到，签到5天即可领取100M流量，抽奖说不定可以抽个宝马。
现在我已转入电信无限流量阵营，写这个脚本主要是因为老妈还在用移动的卡，我也还养着一张没怎么用但绑定了很多东西的移动卡。
我本来只想写个签到的功能，结果抓包发现抽奖的逻辑和签到大同小异，也就一并写了。curl用的是第三方轮子[php-curl-class](https://github.com/php-curl-class/php-curl-class)，后期会替换成自己的轮子。这个小项目拖延了好久，终于今天在公司搬砖的时候，抽了两个小时写出来了，抓包分析的过程挺费时间的。

### 使用方法
#### 申请SendKey
- 点击访问[serverChan](http://pushbear.ftqq.com/admin/#/)
- 点击右上角的“注册&登入”，接着用微信扫码登录
- 登录成功后，来到了通道管理界面，点击“新增通道”，然后填写通道信息并新增
- 新增完成后回到通道管理界面，点击通道的“设置”按钮，就可以看到“本通道的订阅二维码”，扫码关注（通知时所有关注了此通道二维码的人都会收到通知消息）
- 回到通道管理界面，点击通道的“发送消息”按钮，便能看到SendKey
#### 简言之
将config.php中的SSOCookie和sendKey改为正确的即可。SSOCookie是四川移动掌厅验证用户是否登录的cookie，通过抓包取得（偷个懒，如何抓包自行谷歌一下吧）。sendKey是一个叫做serverchan的第三方微信推送接口需要用到的密钥，具体参考[ServerChan官方文档](http://sc.ftqq.com/3.version)取得。定时任务由crontab实现。

### 吐槽
移动越来越鸡贼了。以前连续签到5天即可百分百领取100M流量，现在就算签够天数，也得以抽奖的方式获取流量。
